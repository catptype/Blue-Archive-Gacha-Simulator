{% extends 'general_app/components/base.html' %}
{% load static %}
{% load filters %} <!-- Read custom template tags in filters.py -->

{% block title %}Gacha detail{% endblock %}

{% block content %}
<div class="container">
    <h3>GACHA DETAILS {{ banner.id }}</h3>
    <img src="{% static 'portrait_404.png' %}" alt="banner" style="width:400px; height:200px;">
    <p>{{ banner.name }}</p>
    <!-- Add buttons for 1 draw and 10 draw -->
    <form method="post" action="{% url 'gacha_result' gacha_id=banner.id %}">
        {% csrf_token %}
        {% for num_draw in num_draws %}
        <button class="btn btn-primary p-2 mb-3" type="submit" name="draw" value="{{ num_draw }}">{{ num_draw }} Draw</button>
        {% endfor %}
    </form>
    <!-- Students in banner -->
    <div class="rarity-grid">
        {% for rarity in rarities %}
        <div>
            <h4>{% for _ in "★"|rjust:rarity %}★{% endfor %} ({{ banner|get_rate:rarity }}%)</h4>
            {% if rarity == 3 and banner.is_pickup.all %}
            <div class="student-grid">
                {% for student in banner.is_pickup.all %}
                <div class="student-card">
                    <img src="{{ student.image.url }}" alt="{{ student.name }}_{{ student.version_name }}">
                    <p>{{ student.name }}</p>
                </div>
                {% endfor %}
            </div>
            {% endif %}
            <div class="student-grid">
                {% for student in banner.not_pickup.all %}
                {% if student.rarity == rarity %}
                <div class="student-card">
                    <img src="{{ student.image.url }}" alt="{{ student.name }}_{{ student.version_name }}">
                    <p>{{ student.name }}</p>
                </div>
                {% endif %}
                {% endfor %}
            </div>
        </div>
        {% endfor %}
    </div>
</div>
{% endblock %}